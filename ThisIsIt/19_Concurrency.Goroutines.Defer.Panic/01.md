## –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç—å –≤ Go: –ì–æ—Ä—É—Ç–∏–Ω—ã, `defer`, `panic` –∏ `recover`

–í –¥–∞–Ω–Ω–æ–º –≤–∏–¥–µ–æ—É—Ä–æ–∫–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω—ã –∫–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –≤ —è–∑—ã–∫–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è Go. –ú—ã –∏–∑—É—á–∏–ª–∏, —á—Ç–æ —Ç–∞–∫–æ–µ **–≥–æ—Ä—É—Ç–∏–Ω—ã**, –∫–∞–∫ –∏—Ö —Å–æ–∑–¥–∞–≤–∞—Ç—å, –∫–∞–∫–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –æ–Ω–∏ –º–æ–≥—É—Ç –∏–º–µ—Ç—å, –∞ —Ç–∞–∫–∂–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–ª–∏ –º–µ—Ö–∞–Ω–∏–∑–º—ã **`defer`**, **`panic`** –∏ **`recover`**.

---

### 1. **–ì–æ—Ä—É—Ç–∏–Ω—ã (`goroutines`)**
–ì–æ—Ä—É—Ç–∏–Ω–∞ ‚Äî —ç—Ç–æ –ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã–π –ø–æ—Ç–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤ Go. –û–Ω–∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ª–µ–≥—á–µ, —á–µ–º —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ø–æ—Ç–æ–∫–∏ (threads), —Ç–∞–∫ –∫–∞–∫ —Ç—Ä–µ–±—É—é—Ç –≥–æ—Ä–∞–∑–¥–æ –º–µ–Ω—å—à–µ –ø–∞–º—è—Ç–∏ (–æ–±—ã—á–Ω–æ 2 KB –ø—Ä–æ—Ç–∏–≤ 1 MB —É –ø–æ—Ç–æ–∫–æ–≤).

#### üìå **–†–∞–∑–ª–∏—á–∏–µ –º–µ–∂–¥—É –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç—å—é –∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ—Å—Ç—å—é**
- **–ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç—å**: –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∑–∞–¥–∞—á —Å –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ–º –º–µ–∂–¥—É –Ω–∏–º–∏.
- **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ—Å—Ç—å**: –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∑–∞–¥–∞—á –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —è–¥—Ä–∞—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞.

#### üîπ **–°–æ–∑–¥–∞–Ω–∏–µ –≥–æ—Ä—É—Ç–∏–Ω—ã**
–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≥–æ—Ä—É—Ç–∏–Ω—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ `go` –ø–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º —Ñ—É–Ω–∫—Ü–∏–∏:

```go
package main

import (
	"fmt"
	"time"
)

func showNumbers(n int) {
	for i := 0; i < n; i++ {
		fmt.Println(i)
	}
}

func main() {
	go showNumbers(100) // –∑–∞–ø—É—Å–∫ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π –≥–æ—Ä—É—Ç–∏–Ω–µ
	fmt.Println("Exit") // –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å—Å—è —Ä–∞–Ω—å—à–µ, —á–µ–º –≥–æ—Ä—É—Ç–∏–Ω–∞ –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è
}
```
**–í—ã–≤–æ–¥ –±—É–¥–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–º**, —Ç–∞–∫ –∫–∞–∫ `main` –º–æ–∂–µ—Ç –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è –¥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è `showNumbers`.

#### üîπ **–û—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞: –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ `main` —Ä–∞–Ω—å—à–µ –≤—Ä–µ–º–µ–Ω–∏**
Go –∑–∞–≤–µ—Ä—à–∞–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º—É, –∫–∞–∫ —Ç–æ–ª—å–∫–æ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è `main`, –Ω–µ –¥–æ–∂–∏–¥–∞—è—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –¥—Ä—É–≥–∏—Ö –≥–æ—Ä—É—Ç–∏–Ω.

**–†–µ—à–µ–Ω–∏–µ: —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å `time.Sleep` (–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è, –Ω–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è)**
```go
func main() {
	go showNumbers(100)
	time.Sleep(time.Second) // –∂–¥—ë–º, –ø–æ–∫–∞ –≥–æ—Ä—É—Ç–∏–Ω–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è
	fmt.Println("Exit")
}
```
–í –¥–∞–ª—å–Ω–µ–π—à–µ–º –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è **–∫–∞–Ω–∞–ª—ã** –∏ **WaitGroup**.

#### üîπ **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —á–∏—Å–ª–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –≤—ã–ø–æ–ª–Ω—è–µ–º—ã—Ö –≥–æ—Ä—É—Ç–∏–Ω**
Go –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ (`scheduler`)**, –∫–æ—Ç–æ—Ä—ã–π —É–ø—Ä–∞–≤–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –≥–æ—Ä—É—Ç–∏–Ω. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –≥–æ—Ä—É—Ç–∏–Ω —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —á–∏—Å–ª—É –ª–æ–≥–∏—á–µ—Å–∫–∏—Ö —è–¥–µ—Ä –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞.

```go
package main

import (
	"fmt"
	"runtime"
)

func main() {
	fmt.Println("–õ–æ–≥–∏—á–µ—Å–∫–∏—Ö —è–¥–µ—Ä:", runtime.NumCPU()) // –í—ã–≤–æ–¥–∏—Ç –∫–æ–ª-–≤–æ –ª–æ–≥–∏—á–µ—Å–∫–∏—Ö —è–¥–µ—Ä
}
```

–ú–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å —á–∏—Å–ª–æ –≥–æ—Ä—É—Ç–∏–Ω, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ:
```go
runtime.GOMAXPROCS(1) // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≥–æ—Ä—É—Ç–∏–Ω –æ–¥–Ω–∏–º —è–¥—Ä–æ–º
```
–ï—Å–ª–∏ –∑–∞–¥–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –±–æ–ª—å—à–µ, —á–µ–º —è–¥–µ—Ä –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞, Go –≤—Å—ë —Ä–∞–≤–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç –µ–≥–æ —á–∏—Å–ª–æ–º –ª–æ–≥–∏—á–µ—Å–∫–∏—Ö —è–¥–µ—Ä.

#### üîπ **–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –≥–æ—Ä—É—Ç–∏–Ω–∞–º–∏**
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `runtime.Gosched()`, —á—Ç–æ–±—ã –ø–µ—Ä–µ–¥–∞—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥—Ä—É–≥–æ–π –≥–æ—Ä—É—Ç–∏–Ω–µ.

```go
package main

import (
	"fmt"
	"runtime"
)

func main() {
	go func() {
		for i := 0; i < 5; i++ {
			fmt.Println("–ì–æ—Ä—É—Ç–∏–Ω–∞:", i)
			runtime.Gosched() // –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –¥—Ä—É–≥—É—é –≥–æ—Ä—É—Ç–∏–Ω—É
		}
	}()
	fmt.Println("–ì–ª–∞–≤–Ω–∞—è –≥–æ—Ä—É—Ç–∏–Ω–∞")
}
```
**–ù–æ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `sync.WaitGroup` –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏.**

---

### 2. **–û—Ç–ª–æ–∂–µ–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã (`defer`)**
–ö–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ `defer` –ø–æ–∑–≤–æ–ª—è–µ—Ç **–æ—Ç–ª–æ–∂–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–π —Ñ—É–Ω–∫—Ü–∏–∏**.

#### üîπ **–ü—Ä–∏–º–µ—Ä `defer`**
```go
package main

import "fmt"

func main() {
	defer fmt.Println("–≠—Ç–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–º")
	fmt.Println("–≠—Ç–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–µ—Ä–≤—ã–º")
}
```
**–í—ã–≤–æ–¥:**
```
–≠—Ç–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–µ—Ä–≤—ã–º
–≠—Ç–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–º
```

#### üîπ **–°—Ç–µ–∫ –≤—ã–∑–æ–≤–æ–≤ `defer` (LIFO ‚Äî –ø–æ—Å–ª–µ–¥–Ω–∏–º –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–º, –ø–µ—Ä–≤—ã–º –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–º)**
```go
func main() {
	defer fmt.Println(1)
	defer fmt.Println(2)
	defer fmt.Println(3)
	fmt.Println("Main –∑–∞–≤–µ—Ä—à—ë–Ω")
}
```
**–í—ã–≤–æ–¥:**
```
Main –∑–∞–≤–µ—Ä—à—ë–Ω
3
2
1
```

#### üîπ **–ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è —Å `defer`**
```go
package main

import "fmt"

func sum(a, b int) (result int) {
	defer func() {
		result *= 2 // –∏–∑–º–µ–Ω—è–µ–º –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
	}()
	result = a + b
	return
}

func main() {
	fmt.Println(sum(2, 3)) // 10
}
```

#### üîπ **–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–µ—Ä–µ–¥–∞—á–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π —á–µ—Ä–µ–∑ `defer`**
```go
func main() {
	for i := 0; i < 5; i++ {
		defer fmt.Println(i) // –≤—ã–≤–µ–¥–µ—Ç –≤—Å–µ–≥–¥–∞ 5, –ø–æ—Ç–æ–º—É —á—Ç–æ i –º–µ–Ω—è–µ—Ç—Å—è
	}
}
```
–†–µ—à–µ–Ω–∏–µ ‚Äî –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∫–æ–ø–∏—é –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π:
```go
for i := 0; i < 5; i++ {
	defer func(n int) { fmt.Println(n) }(i)
}
```

---

### 3. **–ü–∞–Ω–∏–∫–∞ (`panic`) –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (`recover`)**
–í Go –ø–∞–Ω–∏–∫–∞ (`panic`) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤—ã—Ö–æ–¥–∞ –∑–∞ –≥—Ä–∞–Ω–∏—Ü—ã –º–∞—Å—Å–∏–≤–∞.

#### üîπ **–ü—Ä–∏–º–µ—Ä `panic`**
```go
package main

import "fmt"

func main() {
	fmt.Println("–î–æ –ø–∞–Ω–∏–∫–∏")
	panic("–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞!") // –ü—Ä–µ—Ä—ã–≤–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã
	fmt.Println("–≠—Ç–∞ —Å—Ç—Ä–æ–∫–∞ –Ω–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è")
}
```
–í—ã–≤–æ–¥:
```
–î–æ –ø–∞–Ω–∏–∫–∏
panic: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞!
```

#### üîπ **–û–±—Ä–∞–±–æ—Ç–∫–∞ `panic` —Å `recover`**
–§—É–Ω–∫—Ü–∏—è `recover()` –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—Ç—å `panic` –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–≤–µ—Ä—à–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ.

```go
package main

import "fmt"

func handlePanic() {
	if r := recover(); r != nil {
		fmt.Println("–ü–∞–Ω–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–∞:", r)
	}
}

func mayPanic() {
	defer handlePanic() // –í—ã–∑—ã–≤–∞–µ–º recover –ø–µ—Ä–µ–¥ –≤—ã—Ö–æ–¥–æ–º
	panic("–ß—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫")
}

func main() {
	fmt.Println("–ü—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–ø—É—â–µ–Ω–∞")
	mayPanic()
	fmt.Println("–ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –ø–∞–Ω–∏–∫–∏")
}
```
–í—ã–≤–æ–¥:
```
–ü—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–ø—É—â–µ–Ω–∞
–ü–∞–Ω–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–∞: –ß—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫
–ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –ø–∞–Ω–∏–∫–∏
```

#### üîπ **–ö–æ–≥–¥–∞ `panic` –æ–ø—Ä–∞–≤–¥–∞–Ω–∞?**
- –û—à–∏–±–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–ª—å–∑—è –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤—ã–¥–µ–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏).
- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏, —Ç—Ä–µ–±—É—é—â–∏–µ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã.

---

## **–í—ã–≤–æ–¥—ã**
1. **–ì–æ—Ä—É—Ç–∏–Ω—ã** –ø–æ–∑–≤–æ–ª—è—é—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ–¥ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –∏–ª–∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ.
2. –î–ª—è **—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏** –≥–æ—Ä—É—Ç–∏–Ω –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è **–∫–∞–Ω–∞–ª—ã** –∏ **`sync.WaitGroup`** (—Ä–∞–∑–±–µ—Ä—ë–º –¥–∞–ª–µ–µ).
3. **`defer`** –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç–ª–æ–∂–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–π —Ñ—É–Ω–∫—Ü–∏–∏.
4. **`panic`** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫.
5. **`recover`** –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –ø–∞–Ω–∏–∫—É –∏ –∏–∑–±–µ–∂–∞—Ç—å –∫—Ä–∞—Ö–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã.

üîπ **–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥**: –†–∞–∑–±–æ—Ä **–∫–∞–Ω–∞–ª–æ–≤ (`channels`)** –∏ —Å–ø–æ—Å–æ–±–æ–≤ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≤ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º–∞—Ö!